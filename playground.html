<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLM Canvas Engine Playground</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            background: #1e1e1e;
            color: #d4d4d4;
            height: 100vh;
            overflow: hidden;
        }

        .playground {
            display: grid;
            grid-template-columns: 1fr 400px 300px;
            grid-template-rows: 40px 1fr 200px;
            height: 100vh;
            gap: 1px;
            background: #333;
        }

        .toolbar {
            grid-column: 1 / -1;
            background: #2d2d30;
            display: flex;
            align-items: center;
            padding: 0 16px;
            gap: 12px;
            border-bottom: 1px solid #3e3e42;
        }

        .toolbar button {
            background: #0e639c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }

        .toolbar button:hover {
            background: #1177bb;
        }

        .toolbar button:disabled {
            background: #666;
            cursor: not-allowed;
        }

        .toolbar select {
            background: #3c3c3c;
            color: #d4d4d4;
            border: 1px solid #5a5a5a;
            padding: 4px 8px;
            border-radius: 3px;
        }

        .canvas-container {
            background: #252526;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        #gameCanvas {
            border: 1px solid #3e3e42;
            background: #000;
        }

        .editor-panel {
            background: #1e1e1e;
            display: flex;
            flex-direction: column;
        }

        .panel-header {
            background: #2d2d30;
            padding: 8px 16px;
            border-bottom: 1px solid #3e3e42;
            font-size: 12px;
            font-weight: bold;
        }

        .editor-container {
            flex: 1;
            position: relative;
        }

        #cartridgeEditor {
            width: 100%;
            height: 100%;
            background: #1e1e1e;
            color: #d4d4d4;
            border: none;
            padding: 16px;
            font-family: inherit;
            font-size: 12px;
            line-height: 1.4;
            resize: none;
            outline: none;
        }

        .validation-panel {
            background: #1e1e1e;
            border-top: 1px solid #3e3e42;
            max-height: 150px;
            overflow-y: auto;
        }

        .validation-error {
            padding: 8px 16px;
            border-left: 3px solid #f14c4c;
            background: rgba(241, 76, 76, 0.1);
            margin: 4px 0;
            font-size: 11px;
        }

        .validation-warning {
            padding: 8px 16px;
            border-left: 3px solid #ffcc02;
            background: rgba(255, 204, 2, 0.1);
            margin: 4px 0;
            font-size: 11px;
        }

        .validation-success {
            padding: 8px 16px;
            border-left: 3px solid #89d185;
            background: rgba(137, 209, 133, 0.1);
            margin: 4px 0;
            font-size: 11px;
        }

        .debug-panel {
            background: #1e1e1e;
            display: flex;
            flex-direction: column;
        }

        .debug-tabs {
            display: flex;
            background: #2d2d30;
            border-bottom: 1px solid #3e3e42;
        }

        .debug-tab {
            padding: 8px 16px;
            cursor: pointer;
            font-size: 11px;
            border-right: 1px solid #3e3e42;
        }

        .debug-tab.active {
            background: #1e1e1e;
        }

        .debug-content {
            flex: 1;
            overflow-y: auto;
            padding: 8px;
        }

        .performance-chart {
            height: 100px;
            background: #252526;
            border: 1px solid #3e3e42;
            margin: 8px 0;
            position: relative;
        }

        .asset-preview {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 8px;
            padding: 8px;
        }

        .asset-item {
            background: #252526;
            border: 1px solid #3e3e42;
            border-radius: 3px;
            padding: 8px;
            text-align: center;
            cursor: pointer;
        }

        .asset-item:hover {
            border-color: #0e639c;
        }

        .asset-item img {
            max-width: 100%;
            max-height: 40px;
            image-rendering: pixelated;
        }

        .asset-item .asset-name {
            font-size: 10px;
            margin-top: 4px;
            word-break: break-all;
        }

        .console-panel {
            grid-column: 1 / -1;
            background: #1e1e1e;
            border-top: 1px solid #3e3e42;
            overflow-y: auto;
            font-size: 11px;
        }

        .console-entry {
            padding: 4px 16px;
            border-bottom: 1px solid #2d2d30;
        }

        .console-error {
            color: #f14c4c;
        }

        .console-warn {
            color: #ffcc02;
        }

        .console-info {
            color: #75beff;
        }

        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
        }

        .hidden {
            display: none !important;
        }

        .fps-counter {
            position: absolute;
            top: 8px;
            left: 8px;
            background: rgba(0, 0, 0, 0.7);
            color: #89d185;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 11px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="playground">
        <div class="toolbar">
            <button id="loadBtn">Load Cartridge</button>
            <button id="runBtn" disabled>Run</button>
            <button id="stopBtn" disabled>Stop</button>
            <button id="resetBtn" disabled>Reset</button>
            <select id="sampleSelect">
                <option value="">Load Sample...</option>
                <option value="pong">Pong Game</option>
                <option value="corridor">Raycast Corridor</option>
                <option value="racer">Mode-7 Racer</option>
            </select>
            <button id="exportBtn" disabled>Export Build</button>
            <button id="validateBtn">Validate</button>
            <span id="statusText">Ready</span>
        </div>

        <div class="canvas-container">
            <canvas id="gameCanvas" width="800" height="600"></canvas>
            <div class="fps-counter" id="fpsCounter">FPS: --</div>
            <div class="loading-overlay hidden" id="loadingOverlay">
                Loading...
            </div>
        </div>

        <div class="editor-panel">
            <div class="panel-header">Cartridge Editor</div>
            <div class="editor-container">
                <textarea id="cartridgeEditor" placeholder="Paste your LGF cartridge JSON here or load a sample..."></textarea>
            </div>
            <div class="validation-panel" id="validationPanel">
                <div class="validation-success">Ready to validate cartridge</div>
            </div>
        </div>

        <div class="debug-panel">
            <div class="debug-tabs">
                <div class="debug-tab active" data-tab="performance">Performance</div>
                <div class="debug-tab" data-tab="assets">Assets</div>
                <div class="debug-tab" data-tab="scene">Scene Tree</div>
            </div>
            <div class="debug-content">
                <div id="performanceTab" class="debug-tab-content">
                    <div>Frame Time (ms)</div>
                    <canvas class="performance-chart" id="frameTimeChart" width="280" height="100"></canvas>
                    <div>Memory Usage (MB)</div>
                    <canvas class="performance-chart" id="memoryChart" width="280" height="100"></canvas>
                    <div id="performanceStats">
                        <div>Avg Frame Time: <span id="avgFrameTime">--</span>ms</div>
                        <div>Min FPS: <span id="minFps">--</span></div>
                        <div>Max FPS: <span id="maxFps">--</span></div>
                        <div>Memory: <span id="memoryUsage">--</span>MB</div>
                    </div>
                </div>
                <div id="assetsTab" class="debug-tab-content hidden">
                    <div class="asset-preview" id="assetPreview">
                        <div class="asset-item">No assets loaded</div>
                    </div>
                </div>
                <div id="sceneTab" class="debug-tab-content hidden">
                    <div id="sceneTree">No scene loaded</div>
                </div>
            </div>
        </div>

        <div class="console-panel" id="consolePanel">
            <div class="console-entry console-info">LLM Canvas Engine Playground ready</div>
        </div>
    </div>

    <input type="file" id="fileInput" accept=".json,.lgf" style="display: none;">

    <script type="module" src="./playground.js"></script>
</body>
</html>